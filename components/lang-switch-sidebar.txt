"use client"

import { usePathname } from "next/navigation"
import { Button } from "@/components/ui/button"
import { Globe } from "lucide-react"
import { locales_, languageNames } from "@/app/[lang]/dictionaries"
import { useRouter } from "next/router"

export function LanguageSwitcherIcon({ currentLang }: { currentLang: string }) {
  const pathname = usePathname()
  const router = useRouter()

  // Remove the current language from the path to get the base route
  const pathnameWithoutLang = pathname.replace(`/${currentLang}`, "") || "/"

  // Create a localized link for the next language
  const nextLocale = locales_[(locales_.indexOf(currentLang) + 1) % locales_.length]
  const nextLocalizedLink = `/${nextLocale}${pathnameWithoutLang}`

  const handleLanguageSwitch = () => {
    router.push(nextLocalizedLink)
  }

  return (
    <Button variant="outline" size="icon" onClick={handleLanguageSwitch}>
      <Globe className="h-[1.2rem] w-[1.2rem]" />
      <span className="sr-only">Switch Language</span>
    </Button>
  )
}